<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>票多多合伙人招募</title>
		<meta charset="utf-8">
		<meta name="apple-touch-fullscreen" content="YES">
		<meta name="format-detection" content="telephone=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">
		<meta http-equiv="Expires" content="-1">
		<meta http-equiv="pragram" content="no-cache">
		<link rel="stylesheet" type="text/css" href="css/main.css">
		<link rel="stylesheet" type="text/css" href="css/endpic.css">
		<script type="text/javascript" src="js/offline.js"></script>
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vant@2.8/lib/index.css" />

		<!-- 引入 Vue 和 Vant 的 JS 文件 -->
		<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/vant@2.8/lib/vant.min.js"></script>
		<meta name="viewport" content="width=640, user-scalable=no, target-densitydpi=device-dpi">
	</head>

	<body class="s-bg-ddd pc no-3d" style="-webkit-user-select: none;">

		<section class="u-arrow">
			<p class="css_sprite01"></p>
		</section>
		<section class="p-ct transformNode-2d" style="height: 100%;">
			<div class="translate-back" style="100%">
				<div class="m-page m-fengye total" data-page-type="info_pic3" data-statics="info_pic3" style="height:100%;">
					<div class="page-con lazy-finish image1 " data-position="50% 50%" data-size="cover" style="background-image: url(images/image1.png); background-size:contain;">
						<img src="./images/pdd.svg" class="icon-image">
					</div>
				</div>
				<div class="m-page m-bigTxt f-hide total" data-page-type="bigTxt" data-statics="info_list" style="height:100%;">
					<div class="page-con j-txtWrap lazy-finish images" data-position="100% 100%" data-size="cover" style="background-image: url(images/image2.png); background-size:contain; ">
<!-- 						<img src="images/image2_tip1.png" class="image2_tip1">
 -->						<!-- <img src="images/top_left.png"  class="img2_top" width="">
						<img src="images/bottom_right.png" class="img2_bottom"> -->
						<!-- <div class="img2_tip">
							为什么选择票多多
						</div>
						<div class="image2_content">
							<div >
								<img src="images/image2_tip1.png" >
							</div>
							<div class="title">
								<div class="main_title">
									旅游圈人脉王
								</div>
								<div class="less_title">
									三年以上旅游行业经验
								</div>
								<div class="less_title">
									在当地有丰富资源
								</div>
							</div>
						</div> -->
					</div>
				</div>
				<div class="m-page m-bigTxt f-hide total" data-page-type="bigTxt" data-statics="info_list" style="height:100%;">
					<div class="page-con j-txtWrap lazy-finish images" data-position="100% 100%" data-size="cover" style="background-image: url(images/image3.png); background-size:contain; "></div>
				</div>
				<div class="m-page m-bigTxt f-hide total" data-page-type="bigTxt" data-statics="info_list" style="height: 100%;">
					<div class="page-con j-txtWrap lazy-finish images" data-position="100% 100%" data-size="cover" style="background-image: url(images/image4.png); background-size:contain; "></div>
				</div>
				<div class="m-page m-bigTxt f-hide total" data-page-type="bigTxt" data-statics="info_list" style="height: 100%;">
					<div class="page-con j-txtWrap lazy-finish images" data-position="100% 100%" data-size="cover" style="background-image: url(images/image5.png); background-size:contain;  ">

						<img src="./images/pdd.svg" class="icon-image">
						<div id="app">
							<van-form @submit="onSubmit">
								<van-cell-group style="margin-top:1.25rem ;font-size: 1.125rem;">
									<van-cell title="加盟城市" is-link required @click="showSelectCity" />
									<template #default>

										<span :class="[selectCityInfo.length>0?'select-sytle':'unselect-style']">{{selectTitle}}<span>
									</template>
									</van-cell>
								</van-cell-group>
								<van-cell-group style="margin-top:1.25rem ;font-size: 1.125rem;">
									<van-field v-model="name" required label="姓名:" placeholder="请输入您的姓名" size="large" maxlength="20" :rules="[{ message: '请输入您的姓名',required: true, }]" />
								</van-cell-group>
								<van-cell-group style="margin-top:1.25rem ;">
									<van-field v-model="phone" required label="手机号:" placeholder="请输入您的联系电话" size="large" maxlength="16" :rules="[{pattern:iphonePattern, message: '请输入正确手机号',required: true, }]" />
								</van-cell-group>
								<van-cell-group style="margin-top:1.25rem ;">
									<van-field v-model="email" required label="邮箱:" placeholder="请填写您的联系邮箱" size="large" border="false" size="large"
									 maxlength="50" :rules="[{ pattern:emailPattern, message: '请输入正确邮箱',required: true, }]" />
								</van-cell-group>
								<van-cell-group style="margin-top:1.25rem;">
									<van-field v-model="message" rows="4" autosize label="优势说明:" type="textarea" size="large" maxlength="600"
									 placeholder="请填写您在加盟当地的资源和优势,600字以内" show-word-limit />
								</van-cell-group>

								<van-popup v-model="show" position="bottom">
									<van-area title="请选择加盟城市" :area-list="areaList" columns-num="2" @confirm="selectCity" @cancel="cancelCity" />
								</van-popup>
								<van-button round type="info" size="large" style="margin-top:1.25rem;" native-type="submit" v-bind:disabled="isDisabled">提交申请</van-button>
							</van-form>
						</div>

					</div>
				</div>

			</div>
		</section>

		<script src="js/init.mix.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/coffee.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/99_main.js" type="text/javascript" charset="utf-8"></script>


	</body>
</html>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vant@2.8/lib/vant.min.js"></script>
<script src="js/area.js"></script>
<script type="text/javascript">
	var app = new Vue({
		el: '#app',

		data: {
			phone: "",
			message: "",
			email: "",
			name: "",
			areaList: AreaList,
			show: false,
			iphonePattern: new RegExp("^[1][3-8][0-9]{9}$"),
			emailPattern: /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/,
			selectCityInfo: [],
			selectTitle: '',
			isDisabled: true,
		},
		methods: {
			showSelectCity() {
				this.show = true;
			},
			selectCity(item) {
				this.selectCityInfo = item;
				this.selectTitle = item[0].name+"-" + item[1].name;
				this.show = false;
				
			},
			cancelCity() {
				this.show = false;
			},
			onSubmit(values) {
				
           var postData = {
               "CityName": this.selectCityInfo[1].name,
               "Name": this.name,
			   "Phone":this.phone,
			   "Mail":this.email,
			   "Remark":this.message.length>0? this.message:"",
			   };
         
           var xhr = new XMLHttpRequest();
           xhr.open("POST", "http://www.hxrhome3.com:9092/User/PartnerCreate", true);
           xhr.setRequestHeader("Content-type","application/json");
           xhr.onreadystatechange = function(){
               var XMLHttpReq = xhr;
			    console.log(XMLHttpReq);
               if (XMLHttpReq.readyState == 4&&XMLHttpReq.status == 200) {
                       var text = XMLHttpReq.responseText;
					   let result =  JSON.parse(text);
                       console.log("result",result);
					   if(result.isSuccess) {
						   vant.Toast('提交申请成功!');
						    window.setTimeout(function() {
						   window.location.reload()			   
						   },1500)
					   } else {
						   vant.Toast('申请失败,请稍后重试');

					   }
                   } else {
					   vant.Toast('申请失败,请稍后重试');
				   }
           };
           xhr.send(JSON.stringify(postData));
			},
			adjutyInfo() {
				let phone = this.phone.replace(/\s*/g, "");
				let email = this.email.replace(/\s*/g, "");
				let name = this.name.replace(/\s*/g, "");
				console.log(phone,email,name,this.selectCityInfo.length);
				if (phone.length > 0 && email.length > 0 && name.length >0 && this.selectCityInfo.length>0) {
					this.isDisabled =false;
				} else {
					this.isDisabled = true;
				}
				
			}
		},
		watch: {
			// 如果 `question` 发生改变，这个函数就会运行
			phone: function(newQuestion, oldQuestion) {
				this.adjutyInfo();
			},
			name: function(newQuestion, oldQuestion) {
				this.adjutyInfo();
			},
			email: function(newQuestion, oldQuestion) {
					this.adjutyInfo();
			},
			selectCityInfo: function(newQuestion, oldQuestion) {
				this.adjutyInfo();
			}
		},
	})
	Vue.use(vant.field);
</script>

<style type="text/css">
	.icon-image {
		width: 4rem;
		position: absolute;
		top: 1.5625rem;
		left: 2.75rem;
	}

	#app {
		background-color: white;
		font-size: 2.125rem !important;
		border-radius: 0.5rem 0.5rem;
		width: 500px;
		height: 560px;
		position: absolute;
		left: 0;
		top: 0;
		bottom: 0;
		right: 0;
		margin: auto;
		z-index：100;
		padding: 0.625rem 0.625rem;
	}
     .img2_top {
		 position: absolute;
		 top: 1.25rem;
		 left: 9.375rem;
	 }
	 .img2_bottom {
		 position: absolute;
		 top: 4.25rem;
		 left: 29.0625rem;
	 }
	 .img2_tip {
		 font-size: 2.5rem;
		 color: white;
		 font-weight: 600;
		 position: absolute;
		 top: 2.1875rem;
		 left: 10.625rem;
	 }
	 .image2_content {
		 display: flex;
		 fle;
	 }
	 .image2_tip1 {
		 position: absolute;
		 top: 18%;
		 left: 7%;
		 width:10.3125rem;
 	 }
	input {
		font-size: 1.125rem !important;

	}

	textarea {
		font-size: 1.125rem !important;

	}

	.select-sytle {
		font-size: 1.125rem !important;
		color: black;
	}

	.unselect-sytle {
		font-size: 1.125rem !important;
		color: red;
	}
	.image1 {
		background-color:#050411 ;
		
	}
	.images {
	
		
	}
	.total {
	background-image: linear-gradient(#0039b1, #2b51bf,#a962cd);
	}
</style>
